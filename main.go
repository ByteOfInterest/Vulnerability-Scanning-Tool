package main

import (
	"fmt"
	"Vulnerability-Scanning-Tool/config"
	"Vulnerability-Scanning-Tool/scanner"
)

func main() {
	// Load configuration from config.json
	config, err := config.LoadConfig("config.json")
	if err != nil {
		fmt.Println("Error loading config:", err)
		return
	}

	// Loop through each target and check for vulnerabilities
	for _, target := range config.Targets {
		fmt.Println("Scanning target:", target)

		for _, vulnType := range config.Vulnerabilities {
			fmt.Println("Checking for vulnerability:", vulnType)
			scanner.CheckVulnerability(target, vulnType, config.Headers)
		}
	}

	fmt.Println("Scan completed. Generating report in Formart:", config.ReportFormat)
}