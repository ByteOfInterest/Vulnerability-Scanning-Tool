package main

import (
	"fmt"
	"Vulnerability-Scanning-Tool/config"
	"Vulnerability-Scanning-Tool/scanner"
)

func main() {
	// Load configuration from config.json
	config, err := config.LoadConfig("config.json")
	if err != nil {
		fmt.Println("Error loading config:", err)
		return
	}

	// All scanners used
	scanners := []scanner.VulnerabilityScanner{
		scanner.SQLInjectionScanner{},
		scanner.XSSScanner{},
		scanner.CSRFScanner{},
		scanner.DirectoryTraversalScanner{},
		// Place for more scanners
	}

	// Loop through each target and check for vulnerabilities
	for _, target := range config.Targets {
		fmt.Println("Scanning target:", target)

		for _, s := range scanners {
			if s.Scan(target, config.Headers) {
				fmt.Println("Vulnerability detected at:", target)
			}
		}
	}

	fmt.Println("Scan completed. Generating report in Format:", config.ReportFormat)
}
