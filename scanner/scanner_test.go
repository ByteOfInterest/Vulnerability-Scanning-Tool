package scanner

import (
    "testing"
    "time"
)

func TestAddAndGetVulnerabilities(t *testing.T) {
    // Clear any existing vulnerabilities (for isolation in tests)
    vulnerabilities = []VulnerabilityDetails{}

    vuln := VulnerabilityDetails{
        Type:       "TestVuln",
        Endpoint:   "http://example.com",
        Payload:    "testPayload",
        DetectedAt: time.Now(),
        Suggestion: "testSuggestion",
    }

    // Add a vulnerability
    AddVulnerability(vuln)

    // Retrieve vulnerabilities and check if it's added correctly
    vulns := GetVulnerabilities()
    if len(vulns) != 1 {
        t.Fatalf("Expected 1 vulnerability, got %d", len(vulns))
    }

    if vulns[0].Type != "TestVuln" {
        t.Errorf("Expected vulnerability type to be 'TestVuln', got %s", vulns[0].Type)
    }
}
