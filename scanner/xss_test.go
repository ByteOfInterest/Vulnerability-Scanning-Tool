package scanner

import (
    "net/http"
    "net/http/httptest"
    "testing"
)

func TestXSSScanner(t *testing.T) {
    // Mock server simulating a vulnerable endpoint
    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        w.Write([]byte("<script>alert('XSS')</script>"))
    }))
    defer ts.Close()

    xssScanner := XSSScanner{}
    headers := map[string]string{}

    // Perform the scan against the mock server
    vulnDetails, found := xssScanner.Scan(ts.URL, headers)
    if !found {
        t.Errorf("Expected XSS vulnerability to be detected, but it wasn't.")
    }

    if vulnDetails.Type != "XSS" {
        t.Errorf("Expected XSS type, got: %s", vulnDetails.Type)
    }
}
